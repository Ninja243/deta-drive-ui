(this["webpackJsonpdrive-ui"]=this["webpackJsonpdrive-ui"]||[]).push([[0],{31:function(e,t,a){},33:function(e,t,a){},52:function(e,t,a){"use strict";a.r(t);var i=a(1),s=a.n(i),n=a(22),r=a.n(n),l=(a(31),a(5)),c=a(12),o=a(9),d=a.n(o),u=a(16),j=a(3),p=a(4),h=a(11),f=a(10),b=(a(33),a(23)),v=a.n(b),x=a(15),m=a(25),O=a(2),w=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(e){var i;return Object(j.a)(this,a),(i=t.call(this,e)).componentDidMount=Object(u.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!==i.state.projectKey&&null!==i.state.driveName&&i.refreshFiles();case 1:case"end":return e.stop()}}),e)}))),i.refreshFiles=Object(u.a)(d.a.mark((function e(){var t,a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(x.Deta)(i.state.projectKey),a=t.Drive(i.state.driveName),e.next=4,a.list();case 4:s=e.sent,i.setState({files:[],filesToUpload:[]}),s.names.forEach(function(){var e=Object(u.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={key:t},i.state.files.push(a);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i.setState({});case 8:case"end":return e.stop()}}),e)}))),i.handleSelected=function(e,t){var a=Object(x.Deta)(i.state.projectKey).Drive(i.state.driveName),s=e.key;"undefined"===typeof t?a.get(s).then((function(e){var t=(window.URL||window.webkitURL).createObjectURL(e);console.log(e),i.setState({previewFile:{url:t,file:e,name:s}})})):a.get(t+e.key)},i.updateProjectKeyInputTextValue=function(e){i.setState({_projectKeyInputText:e.target.value})},i.updateDriveNameTextValue=function(e){i.setState({_driveNameInputText:e.target.value})},i.uploadStoredFiles=Object(u.a)(d.a.mark((function e(){var t,a,s,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(x.Deta)(i.state.projectKey),a=t.Drive(i.state.driveName),console.log(i.state.filesToUpload),s=Object(c.a)(i.state.filesToUpload);try{for(r=function(){var e=n.value;console.log(e);var t=new FileReader,s="binary/octet-stream";["bmp","cod","gif","ief","jpe","jpeg","jpg","jfif","png","svg"].includes(e.name.slice((Math.max(0,e.name.lastIndexOf("."))||1/0)+1))&&(s="image/"+e.name.substring(e.name.lastIndexOf(".")+1)),["mp4","webm"].includes(e.name.slice((Math.max(0,e.name.lastIndexOf("."))||1/0)+1))&&(s="video/"+e.name.substring(e.name.lastIndexOf(".")+1)),["wav","wave","ogg","mp3"].includes(e.name.slice((Math.max(0,e.name.lastIndexOf("."))||1/0)+1))&&(s="audio/"+e.name.substring(e.name.lastIndexOf(".")+1)),t.onload=function(){var n=new Uint8Array(t.result),r=a.put(e.name,{data:n,contentType:s}).then((function(){null!==r&&i.setState({filesToUpload:i.state.filesToUpload.splice(i.state.filesToUpload.indexOf(e),1)})}))},console.log(t),t.readAsArrayBuffer(e),i.state.filesToUpload.length>0&&console.error("Failed to upload files",i.state.filesToUpload)},s.s();!(n=s.n()).done;)r()}catch(l){s.e(l)}finally{s.f()}case 5:case"end":return e.stop()}}),e)}))),i.state={_projectKeyInputText:"",_driveNameInputText:"",errorText:null,previewFile:null,count:0,files:[],projectKey:null,driveName:null,uploadModalVisible:!1,filesToUpload:[],fileDropText:"Drop your files here"},i}return Object(p.a)(a,[{key:"render",value:function(){var e,t,a,i,s=this;return Object(O.jsx)("div",{className:"App",children:Object(O.jsxs)("div",{className:"w2 pcolor",children:[Object(O.jsx)("br",{}),Object(O.jsx)("br",{}),Object(O.jsx)("nav",{className:"navbar pcolor",role:"navigation","aria-label":"main navigation",children:Object(O.jsxs)("div",{className:"navbar-brand",children:[Object(O.jsx)("a",{className:"navbar-item nav1",href:"https://deta.sh",children:Object(O.jsx)("img",{alt:"",src:"https://uploads-ssl.webflow.com/5eb96efa78dc680fc15be3be/5ec58c9b49c21c4535eead5a_logo-250.png",className:"img1"})}),Object(O.jsx)("h2",{className:"navbar-item header1",children:" Deta Drive Explorer"})]})}),null===this.state.projectKey||null===this.state.driveName?Object(O.jsx)("header",{children:Object(O.jsxs)("h3",{className:"subtitle is-4",children:["Exploring your Deta Drive is now only a few clicks away! ",Object(O.jsx)("br",{}),Object(O.jsx)("i",{children:"Heavily"})," based on ",Object(O.jsx)("a",{href:"https://explorer.deta.dev/",target:"_blank",rel:"noreferrer",children:"Deta Base Explorer"}),". Check out the code for this project at ",Object(O.jsx)("span",{children:Object(O.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://github.com/Ninja243/deta-base-explorer",children:"GitHub"})}),"."]})}):Object(O.jsx)("div",{className:"signOut",children:Object(O.jsx)("button",{onClick:function(){s.setState({driveName:null,projectKey:null})},children:"Sign out"})}),Object(O.jsx)("section",{children:null!==this.state.projectKey&&null!==this.state.driveName?null!==this.state.previewFile?Object(O.jsxs)("div",{children:[Object(O.jsx)("h1",{className:"previewHeader",children:"Preview"}),Object(O.jsx)("button",{onClick:function(){s.refreshFiles(),s.setState({previewFile:null})},children:"\u2039"}),(null===(e=this.state.previewFile.file.type)||void 0===e?void 0:e.startsWith("image"))?Object(O.jsx)("div",{className:"preview",children:Object(O.jsx)("img",{alt:"A preview of the stored file",src:this.state.previewFile.url})}):(null===(t=this.state.previewFile.file.type)||void 0===t?void 0:t.startsWith("video"))?Object(O.jsx)("div",{className:"preview",children:Object(O.jsx)("video",{src:this.state.previewFile.url})}):(null===(a=this.state.previewFile.file.type)||void 0===a?void 0:a.startsWith("audio"))?Object(O.jsx)("div",{className:"preview",children:Object(O.jsx)("audio",{src:this.state.previewFile.url,controls:!0})}):(null===(i=this.state.previewFile.file.type)||void 0===i?void 0:i.startsWith("text"))?Object(O.jsx)("div",{className:"preview",children:Object(O.jsx)("pre",{children:((new FileReader).onload=function(e){return e}).readAsText(this.state.previewFile.file)})}):Object(O.jsx)("div",{className:"preview",children:Object(O.jsx)("h3",{children:"File can't be previewed"})}),Object(O.jsxs)("div",{className:"controls",children:[Object(O.jsxs)("button",{onClick:function(){Object(x.Deta)(s.state.projectKey).Drive(s.state.driveName).delete(s.state.previewFile.name),s.state.files.splice(s.state.files.indexOf(s.state.previewFile),1),s.setState({previewFile:null}),s.refreshFiles()},children:["Delete ",this.state.previewFile.name]}),Object(O.jsxs)("button",{onClick:function(){window.location.href=s.state.previewFile.url},children:["Download ",this.state.previewFile.name]})]})]}):Object(O.jsx)("div",{children:this.state.uploadModalVisible?Object(O.jsxs)("div",{children:[Object(O.jsx)("button",{onClick:function(){s.setState({uploadModalVisible:!1})},children:"\u2039"}),Object(O.jsx)(m.FileDrop,{className:"uploadBox",onDrop:function(e,t){t.preventDefault(),s.setState({filesToUpload:e},(function(){s.setState({fileDropText:"Uploading ..."},(function(){s.uploadStoredFiles().then((function(){s.setState({fileDropText:"Drop your files here",uploadModalVisible:!1},(function(){s.refreshFiles()}))}))}))}))},children:this.state.fileDropText})]}):Object(O.jsxs)("div",{children:[Object(O.jsx)("button",{onClick:function(){s.setState({uploadModalVisible:!0})},children:"Upload files"}),Object(O.jsx)("button",{className:"refreshButton",onClick:function(){s.refreshFiles()},children:"Refresh"}),Object(O.jsx)(v.a,{className:"fb",files:this.state.files,onSelect:this.handleSelected})]})}):Object(O.jsxs)("div",{children:[Object(O.jsx)("h1",{children:"Enter your drive info"}),Object(O.jsxs)("div",{className:"signInForm",children:[Object(O.jsx)("input",{value:this.state._projectKeyInputText,onChange:function(e){return s.updateProjectKeyInputTextValue(e)},placeholder:"Project key"}),Object(O.jsx)("br",{}),Object(O.jsx)("input",{value:this.state._driveNameInputText,onChange:function(e){return s.updateDriveNameTextValue(e)},placeholder:"Drive Name"}),Object(O.jsx)("br",{}),Object(O.jsx)("button",{onClick:function(){try{Object(x.Deta)(s.state._projectKeyInputText).Drive(s.state._driveNameInputText).list(),s.setState(Object(l.a)(Object(l.a)({},s.setState),{},{projectKey:s.state._projectKeyInputText,driveName:s.state._driveNameInputText}),(function(){console.log(s.state.projectKey),console.log(s.state.driveName),s.refreshFiles()}))}catch(e){s.setState({errorText:"Something's not right with your credentials. Please check them and try again."})}},children:"Sign in"})]}),Object(O.jsx)("br",{}),null===this.state.errorText?Object(O.jsx)("span",{}):Object(O.jsx)("p",{className:"signInError",children:this.state.errorText})]})})]})})}}]),a}(i.Component),g=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,53)).then((function(t){var a=t.getCLS,i=t.getFID,s=t.getFCP,n=t.getLCP,r=t.getTTFB;a(e),i(e),s(e),n(e),r(e)}))};r.a.render(Object(O.jsx)(s.a.StrictMode,{children:Object(O.jsx)(w,{})}),document.getElementById("root")),g()}},[[52,1,2]]]);
//# sourceMappingURL=main.b65ab015.chunk.js.map